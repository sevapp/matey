<!-- # Matey

Matey - –º–æ–¥—É–ª—å –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∫–æ–Ω—Å–æ–ª—å–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ —Å —Å—É–±–∫–æ–º–∞–Ω–¥–∞–º–∏, –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏, –æ–ø—Ü–∏—è–º–∏ –∏ —Ñ–ª–∞–≥–∞–º–∏.

–î–≤–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: _Cli_ –∏ _ComandBuilder_. _Cli_ - —ç—Ç–æ –∫–ª–∞—Å—Å, –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã, –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –æ—à–∏–±–æ–∫. _CommandBuilder_ - —ç—Ç–æ –∫–ª–∞—Å—Å, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã, –¥–æ–±–∞–≤–ª—è—Ç—å –∏—Ö –≤ _Cli_ –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∏—Ö (–æ–ø—Ü–∏–∏, —Ñ–ª–∞–≥–∏, –∞—Ä–≥—É–º–µ–Ω—Ç—ã, —Å—É–±–∫–æ–º–∞–Ω–¥—ã –∏ —Ç.–¥.).

–ö–æ–º–∞–Ω–¥—ã –º–æ–≥—É—Ç –±—ã—Ç—å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∫–æ–Ω—Å–æ–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

---

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [Matey](#matey)
  - [–û–≥–ª–∞–≤–ª–µ–Ω–∏–µ](#–æ–≥–ª–∞–≤–ª–µ–Ω–∏–µ)
  - [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (–∫—Ä–∞—Ç–∫–æ)](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–∫—Ä–∞—Ç–∫–æ)
  - [–ü—Ä–∏–º–µ—Ä](#–ø—Ä–∏–º–µ—Ä)
  - [–ú–∏–¥–ª–≤–∞—Ä—å](#–º–∏–¥–ª–≤–∞—Ä—å)

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (–∫—Ä–∞—Ç–∫–æ)

–û–ø–∏—à–∏—Ç–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤ –≤–∏–¥–µ
[![Typing SVG](https://readme-typing-svg.demolab.com?font=Fira+Code&duration=900&pause=20&multiline=true&width=605&height=200&lines=const+argA_1+%3D+%7B;%E3%85%A4%E3%85%A4name%3A+'--argA_1'%2C;%E3%85%A4%E3%85%A4description%3A+'argA_1+description'%2C;%E3%85%A4%E3%85%A4type%3A+ArgumentType.OPTION%2C;%E3%85%A4%E3%85%A4valueValidator%3A+(val%3Astring)+%3D%3E+val.length+%3E+10%2C;%E3%85%A4%E3%85%A4optionNameRequired%3A+true%2C;+%E3%85%A4%E3%85%A4required%3A+false%2C;%7D)](https://git.io/typing-svg)

–û–ø–∏—à–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤ –≤–∏–¥–µ
[![Typing SVG](https://readme-typing-svg.demolab.com?font=Fira+Code&duration=900&pause=20&multiline=true&width=605&height=200&lines=const+cmdA+%3D+new+CommandBuilder();%E3%85%A4%E3%85%A4.setName('commandName');%E3%85%A4%E3%85%A4.setDescription('commandDescription');%E3%85%A4%E3%85%A4.addArgument(argA_1);%E3%85%A4%E3%85%A4.addArgument(argA_2);%E3%85%A4%E3%85%A4.setHandler((args%3A+HandlerArgs)+%3D%3E+{;+%E3%85%A4%E3%85%A4console.log(args);%7D);)](https://git.io/typing-svg)

–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π cli –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –∫ –Ω–µ–º—É –∫–æ–º–∞–Ω–¥—ã –∏ –º–∏–¥–ª–≤–∞—Ä–∏
[![Typing SVG](https://readme-typing-svg.demolab.com?font=Fira+Code&duration=900&pause=20&multiline=true&width=605&height=200&lines=const+cli+%3D+new+Cli();%E3%85%A4%E3%85%A4.addCommand(cmdA);%E3%85%A4%E3%85%A4.addCommand(cmdB);%E3%85%A4%E3%85%A4.use(rexExpA,handlerA);%E3%85%A4%E3%85%A4.use(rexExpA,handlerA);)](https://git.io/typing-svg)

## –ü—Ä–∏–º–µ—Ä

–ü—É—Å—Ç—å –º—ã —Ö–æ—Ç–∏–º –ø–æ–ª—É—á–∞—Ç—å –∫–æ–º–º–∏—Ç-—Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º –≤ –ø—Ä–æ–µ–∫—Ç–µ –∫–æ–º–∞–Ω–¥–æ–π –≤–∏–¥–∞ _commit generate_ _[--maxTokens] \<number\> [--short]_

```ts
// main.ts
import { Cli } from '../../mod.ts';
import { commit, generate } from './command.ts';
import { helpMiddleware } from './middleware.ts';

const cli = new Cli();
cli
  .addCommand(commit)
  .addCommand(generate)
  .use(helpMiddleware.pattern, helpMiddleware.handler);

await cli.execute`commit generate --short`;
```

–í—ã–≥–ª—è–¥–∏—Ç –∫–ª–∞—Å—Å–Ω–æ, –≤–µ—Ä–Ω–æ?
–ü–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω _./command.ts_
>–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º [shelly](https://deno.land/x/shelly@v0.1.1/mod.ts) –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ _git diff_
>–ê —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é _generateCommit_ –ø—Ä–∏–≤–æ–¥–∏—Ç—å –Ω–µ –±—É–¥–µ–º

```ts
// command.ts
// –¢—É—Ç –ø—Ä–æ–ø–∏—Å–∞—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç
import {
  ArgumentType,
  CliCommandBuilder,
  HandlerArgs,
  ICommandArgument,
} from '../../src/mod.ts';
import { generateCommit } from './generateCommit.ts';
import validateFunctions from '../../src/validateFunctions.ts';

// –û–ø–∏—à–µ–º –∞—Ä–≥—É–º–µ–Ω—Ç-–æ–ø—Ü–∏—é, –æ—Ç–≤–µ—á–∞—é—â—É—é –∑–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –æ—Ç–≤–µ—Ç–µ
const tokenArgument: ICommandArgument = {
  name: '--maxTokens',
  description: 'Maximum number of tokens to generate',
  type: ArgumentType.OPTION,
  valueValidator: validateFunctions.numberValidate,
  optionNameRequired: true,
  required: false,
};

// –ê—Ä–≥—É–º–µ–Ω—Ç-—Ñ–ª–∞–≥, –µ—Å–ª–∏ –Ω—É–∂–µ–Ω –∫–æ—Ä–æ—Ç–∫–∏–π –∫–æ–º–º–∏—Ç
const shortArgument: ICommandArgument = {
  name: '--short',
  description: 'Generate short commit message',
  type: ArgumentType.FLAG,
  required: false,
};

// –û–ø–∏—Å—ã–≤–∞–µ–º –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç—ã –∫–æ–º–∞–Ω–¥—ã
const generateHandler = async (args: HandlerArgs) => {
  let { '--maxTokens': maxTokens, '--short': short } = args;
  const diff = await (await shelly('git diff')).stdout;
  maxTokens = short ? '20' : maxTokens || '50';
  const commitMessage = await generateCommit(
    diff,
    parseInt(maxTokens as string, 10)!,
  );
  console.log(commitMessage);
};

// –°–æ–±–∏—Ä–∞–µ–º –Ω–∞—à—É generate –∫–æ–º–∞–Ω–¥—É
export const generate = new CliCommandBuilder()
  .setName('generate')
  .setDescription('Generate commit message based on git diff')
  .addArgument(tokenArgument)
  .addArgument(shortArgument)
  .setHandler(generateHandler)
  .build();

// –ü—É—Å—Ç—å generate —è–≤—è–ª–µ—Ç—Å—è —Å—É–±–∫–æ–º–∞–Ω–¥–æ–π –∫–∞–∫–æ–π-—Ç–æ –≥–ª–∞–≤–Ω–æ–π
// –∫–æ–º–∞–Ω–¥—ã commit
export const commit = new CliCommandBuilder()
  .setName('commit')
  .setDescription('Commit commands')
  .addSubcommand(generate)
  .setHandler((args) => {})
  .build();
```

–í–º–µ—Å—Ç–æ _validateFunctions.numberValidate_ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≤–æ—é —Å—Ç—Ä–µ–ª–æ—á–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –≤–∏–¥–∞ _string => boolean_

## –ú–∏–¥–ª–≤–∞—Ä—å

–ï—Å–ª–∏ –ø–µ—Ä–µ–¥ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–æ–º–∞–Ω–¥—ã –Ω—É–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∑–∞–ø—Ä–æ—Å, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∏–¥–ª–≤–∞—Ä—å. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –º–∏–¥–ª–≤–∞—Ä—å –∏ –Ω–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—É, –≤–µ—Ä–Ω–∏—Ç–µ _false_ –∏–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –º–∏–¥–ª–≤–∞—Ä–∏.

```ts
//middleware.ts
const helpMiddleware = {
  pattern: / help /,
  handler: (lexemes: ILexeme[]) => {
    const toHelpCmds = lexemes.filter((lexeme) => {
      return lexeme.type === LexemeType.COMMAND;
    }).map((cmd) => cmd.content);
    console.log(`Find commands ${toHelpCmds} `);
    return false;
  },
};
``` -->

# Matey

Matey - –º–æ–¥—É–ª—å –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∫–æ–Ω—Å–æ–ª—å–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ —Å —Å—É–±–∫–æ–º–∞–Ω–¥–∞–º–∏, –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏, –æ–ø—Ü–∏—è–º–∏ –∏ —Ñ–ª–∞–≥–∞–º–∏.

Matey —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–≤–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: _Cli_ –∏ _ComandBuilder_. _Cli_ - —ç—Ç–æ –∫–ª–∞—Å—Å, –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã, –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ. _CommandBuilder_ - —ç—Ç–æ –∫–ª–∞—Å—Å, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã, –¥–æ–±–∞–≤–ª—è—Ç—å –∏—Ö –≤ _Cli_ –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∏—Ö (–æ–ø—Ü–∏–∏, —Ñ–ª–∞–≥–∏, –∞—Ä–≥—É–º–µ–Ω—Ç—ã, —Å—É–±–∫–æ–º–∞–Ω–¥—ã –∏ —Ç.–¥.).

–ö–æ–º–∞–Ω–¥—ã –º–æ–≥—É—Ç –±—ã—Ç—å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∫–æ–Ω—Å–æ–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

> –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–∏–∞–ª–æ–≥–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞.

---

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [Matey](#matey)
  - [–û–≥–ª–∞–≤–ª–µ–Ω–∏–µ](#–æ–≥–ª–∞–≤–ª–µ–Ω–∏–µ)
  - [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
    - [–°—Ö–µ–º–∞—Ç–∏—á–Ω—ã–π –ø—Ä–∏–º–µ—Ä](#—Å—Ö–µ–º–∞—Ç–∏—á–Ω—ã–π-–ø—Ä–∏–º–µ—Ä)
    - [–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (–æ—Ç–ø—Ä–∞–≤–∫–∞ email)](#–ø—Ä–∏–º–µ—Ä-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-–æ—Ç–ø—Ä–∞–≤–∫–∞-email)
    - [–ü—Ä–∏–º–µ—Ä –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π](#–ø—Ä–∏–º–µ—Ä-–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π)
  - [Middleware](#middleware)

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –°—Ö–µ–º–∞—Ç–∏—á–Ω—ã–π –ø—Ä–∏–º–µ—Ä

> üîß –û–ø–∏—Å—ã–≤–∞–π—Ç–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã-**–æ–ø—Ü–∏–∏**(–∫–æ—Ç–æ—Ä—ã–µ —Ö—Ä–∞–Ω—è—Ç –∫–∞–∫–æ–µ-—Ç–æ –ø–æ–ª–µ–∑–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ) –∫–∞–∂–¥–æ–π –∫–æ–º–∞–Ω–¥—ã –≤ –≤–∏–¥–µ

```ts
const argA_1: ICommandArgument = {
  name: 'argA_1',
  description: 'argA_1 description',
  type: ArgumentType.OPTION,
  valueValidator: (val: string) => val.length > 0,
  optionNameRequired: true,
  required: true,
};
```

> üö© –û–ø–∏—Å—ã–≤–∞–π—Ç–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã-**—Ñ–ª–∞–≥–∏**(–Ω–∞–ª–∏—á–∏–µ –∫–æ—Ç–æ—Ä—ã—Ö —Å–∞–º–æ –ø–æ —Å–µ–±–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –ª–æ–≥–∏–∫—É –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞) –∫–∞–∂–¥–æ–π –∫–æ–º–∞–Ω–¥—ã –≤ –≤–∏–¥–µ

```ts
const argA_2: ICommandArgument = {
  name: 'argA_2',
  description: 'argA_2 description',
  type: ArgumentType.FLAG,
  required: false,
};
```

> ‚ö° –û–ø–∏—Å—ã–≤–∞–π—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤ –≤–∏–¥–µ

```ts
const cmdA = new CliCommandBuilder()
  .setName('cmdA')
  .setDescription('cmdA description')
  .addArgument(argA_1)
  .addArgument(argA_2)
  .addSubcommand(subA)
  .setHandler(handlerA)
  .build();
```

> üõ°Ô∏è –°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π cli –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –∫ –Ω–µ–º—É –∫–æ–º–∞–Ω–¥—ã –∏ –º–∏–¥–ª–≤–∞—Ä–∏

```ts
const cli = new Cli();
cli
  .addCommand(cmdA)
  .addCommand(cmdB)
  .addCommand(cmdC)
  .use(rexExpA, handlerA)
  .use(rexExpB, handlerB);
```

> üöÄ –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É

```ts
cli.execute`cmdA --argA_1 "Hello" --argA_2 150`;
```

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (–æ—Ç–ø—Ä–∞–≤–∫–∞ email)

- –û–ø–∏—à–µ–º –∫–æ–º–∞–Ω–¥—É –∏ –µ–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã
  ```ts
  import {
    ArgumentType,
    Cli,
    CliCommandBuilder,
    HandlerArgs,
    validateFunctions,
  } from '../mod.ts';

  const emailCommand = new CliCommandBuilder()
    .setName('email')
    .setDescription('Send an email to a specified email address')
    .addArgument({
      name: '--email',
      description: 'The email address to send the email to',
      type: ArgumentType.OPTION,
      valueValidator: validateFunctions.emailValidate,
      required: true,
    })
    .addArgument({
      name: '--msg',
      description: 'The message to include in the email',
      type: ArgumentType.OPTION,
      required: true,
    })
    .setHandler(emailHandler)
    .build();
  ```

- –î–∞–ª–µ–µ –ø—Ä–æ–¥—É–º–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤

  –ü—É—Å—Ç—å —ç—Ç–æ –±—É–¥–µ—Ç "–æ—Ç–ø—Ä–∞–≤–∫–∞" —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ –∞–¥—Ä–µ—Å—É, —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –≤ –∞—Ä–≥—É–º–µ–Ω—Ç–µ _--email_

  **–û–ø–∏—Å–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ª—É—á—à–µ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ –∏–ª–∏ –¥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã**
  ```ts
  const emailHandler = (options: HandlerArgs) => {
    console.log(
      `Email sent to ${options['--email']} with message: ${
        options['--msg']
      }`,
    );
  };
  ```
- –°–æ–∑–¥–∞–¥–∏–º —ç–∫–∑–µ–º–ø–ª—è—Ä _Cli_ –∏ –¥–æ–±–∞–≤–∏–º –≤ –Ω–µ–≥–æ –∫–æ–º–∞–Ω–¥—É
  ```ts
  const cli = new Cli();
  cli.addCommand(emailCommand);

  await cli.execute`email example@example.com "Hello, World!"`;
  // –í—ã–≤–µ–¥–µ—Ç –≤ –∫–æ–Ω—Å–æ–ª—å: Email sent to example@example.com with message: "Hello, World!"
  ```

### –ü—Ä–∏–º–µ—Ä –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π

–ü—É—Å—Ç—å –º—ã —Ö–æ—Ç–∏–º –ø–æ–ª—É—á–∞—Ç—å –∫–æ–º–º–∏—Ç-—Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º –≤ –ø—Ä–æ–µ–∫—Ç–µ –∫–æ–º–∞–Ω–¥–æ–π –≤–∏–¥–∞ _commit generate_ _[--maxTokens] \<number\> [--short]_

```ts
// main.ts
//–¢–£–¢ –ü–†–û–ü–ò–°–ê–¢–¨ –ù–û–†–ú–ê–õ–¨–ù–´–ô –ò–ú–ü–û–†–¢
import { Cli } from '../../mod.ts';
import { commit, generate } from './command.ts';
import { helpMiddleware } from './middleware.ts';

const cli = new Cli();
cli
  .addCommand(commit)
  .addCommand(generate)
  .use(helpMiddleware.pattern, helpMiddleware.handler);

await cli.execute`commit generate --short`;
```

–ü–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω _./command.ts_
>–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º [shelly](https://deno.land/x/shelly@v0.1.1/mod.ts) –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ _git diff_
>–ê —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é _generateCommit_ –ø—Ä–∏–≤–æ–¥–∏—Ç—å –Ω–µ –±—É–¥–µ–º

```ts
// command.ts
import {
  ArgumentType,
  CliCommandBuilder,
  HandlerArgs,
  ICommandArgument,
} from 'https://deno.land/x/matey/mod.ts';
import { generateCommit } from './generateCommit.ts';
import validateFunctions from '../../src/validateFunctions.ts';

// –û–ø–∏—à–µ–º –∞—Ä–≥—É–º–µ–Ω—Ç-–æ–ø—Ü–∏—é, –æ—Ç–≤–µ—á–∞—é—â—É—é –∑–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –æ—Ç–≤–µ—Ç–µ
const tokenArgument: ICommandArgument = {
  name: '--maxTokens',
  description: 'Maximum number of tokens to generate',
  type: ArgumentType.OPTION,
  valueValidator: validateFunctions.numberValidate,
  optionNameRequired: true,
  required: false,
};

// –ê—Ä–≥—É–º–µ–Ω—Ç-—Ñ–ª–∞–≥, –µ—Å–ª–∏ –Ω—É–∂–µ–Ω –∫–æ—Ä–æ—Ç–∫–∏–π –∫–æ–º–º–∏—Ç
const shortArgument: ICommandArgument = {
  name: '--short',
  description: 'Generate short commit message',
  type: ArgumentType.FLAG,
  required: false,
};

// –û–ø–∏—Å—ã–≤–∞–µ–º –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç—ã –∫–æ–º–∞–Ω–¥—ã
const generateHandler = async (args: HandlerArgs) => {
  let { '--maxTokens': maxTokens, '--short': short } = args;
  const diff = await (await shelly('git diff')).stdout;
  maxTokens = short ? '20' : maxTokens || '50';
  const commitMessage = await generateCommit(
    diff,
    parseInt(maxTokens as string, 10)!,
  );
  console.log(commitMessage);
};

// –°–æ–±–∏—Ä–∞–µ–º –Ω–∞—à—É generate –∫–æ–º–∞–Ω–¥—É
export const generate = new CliCommandBuilder()
  .setName('generate')
  .setDescription('Generate commit message based on git diff')
  .addArgument(tokenArgument)
  .addArgument(shortArgument)
  .setHandler(generateHandler)
  .build();

// –ü—É—Å—Ç—å generate —è–≤—è–ª–µ—Ç—Å—è —Å—É–±–∫–æ–º–∞–Ω–¥–æ–π –∫–∞–∫–æ–π-—Ç–æ –≥–ª–∞–≤–Ω–æ–π
// –∫–æ–º–∞–Ω–¥—ã commit
export const commit = new CliCommandBuilder()
  .setName('commit')
  .setDescription('Commit commands')
  .addSubcommand(generate)
  .setHandler((args) => {})
  .build();
```

–í–º–µ—Å—Ç–æ _validateFunctions.numberValidate_ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≤–æ—é —Å—Ç—Ä–µ–ª–æ—á–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –≤–∏–¥–∞ _string => boolean_

## Middleware

–ï—Å–ª–∏ –ø–µ—Ä–µ–¥ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–æ–º–∞–Ω–¥—ã –Ω—É–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∑–∞–ø—Ä–æ—Å, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ middleware. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ middleware –∏ –Ω–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—É, –≤–µ—Ä–Ω–∏—Ç–µ _false_ –∏–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ middleware.

```ts
//middleware.ts
const helpMiddleware = {
  pattern: / help /,
  handler: (lexemes: ILexeme[]) => {
    const toHelpCmds = lexemes.filter((lexeme) => {
      return lexeme.type === LexemeType.COMMAND;
    }).map((cmd) => cmd.content);
    console.log(`Find commands ${toHelpCmds} `);
    return false;
  },
};
```
